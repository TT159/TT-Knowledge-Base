---
date: 2025-07-23
tags:
  - ML
---

今晚在思考三毛的硕士的项目提案，他要开始硕士毕业课题了，还在探索课题阶段，和我讲了大致思路，我也一起思考了一下。三毛今天要返回珠海啦， 放暑假就回长沙帮着一起带小叮当了。

他想探究影响人们会重游/再访珠海的影响因素。

我想了一下，设置一些特征（比如游客的性别， 年龄段，旅游预算，旅游天数，目标景点类型（室内展馆/自然风光/现代高楼大厦商业街/饮食打卡/），出行模式（单人游， 情侣， 家庭模式 ），等等各类因素，可以整理下，且应该尽量让这些特征不能重合，你中有我，我中有你这样的特征，无法带来有效的区分度和评估价值。

输入变量（特征）X：

| 维度    | 特征（示例）                            |
| ----- | --------------------------------- |
| 人口统计学 | 性别、年龄、受教育程度、收入水平、常住地              |
| 行为偏好  | 景点类型偏好（自然/现代/历史）、出行方式、同伴类型（独自/家庭） |
| 实际体验  | 游玩天数、花费预算、访问景点数、天气满意度             |
| 情感变量  | 对城市交通/食物/服务/人文的满意度                |
| 心理变量  | 是否感到放松、有趣、安全、新颖、舒适                |


建立好这些特征后，需要设置一个预测目标，可以是一个打分，给珠海的这趟游玩打分（1~5分）。以及是否会再来珠海旅游（会，不会）。

这样还可以用这两个来做一个交叉验证，看预测模型是否准确。即先不给模型提供是否再会来珠海旅游这个问题的用户答案，然后用其他的特征以及打分这一个特征，训练模型，然后用这个模型，去预测这些用户是否会再来珠海，看看这个预测是否与真实的用户答案一致，一致性有多高。如果预测准确率高，则说明模型训练有效，给特征赋值的权重参数是合理的。

当然，也可以简单的评估模型的准确性。比如，有1000个用户填了问卷，相当于我们收集了1000条数据，我们用800条数据来训练模型，剩下200条来测试即可。

目标变量 Y（输出）： **你是否愿意再次来珠海？**
- 类型 1：打分（1～5）
-  类型 2：二分类（愿意 / 不愿意）


这样就是一个建立模型的过程。将这个问题用数学来模拟。类似函数 y = a * x1 + b * x2 + .....
x1, x2就是我们设置的各种特征，y就是我们的预测目标。通过机器学习训练来尽力拟合这个曲线，找到最合适的权重参数a, b, ..... 这些权重的数值某种程度上就反映了这个权重对应的特征对预测值的影响程度。比如 x1是


==注意，严谨的说, **权重大只是说明它** 和重游意愿在统计上**共同变化，即高度相关，但不能简单地认为代表它“导致”了这个意愿。==

因为，如果特征之间存在**多重共线性** (就是前面说的我中有你，你中有我这样的)，权重就不稳。

比如这两个特征：
- A = 是否住高端酒店；
- B = 是否预算高。

这两个特征往往高度相关（共线），（预算高的就大概率住高端酒店），线性模型训练时会“随机分摊”权重给 A 或 B：

- 有时 A 权重大，有时 B 权重大；
- 但其实它们在“逻辑上是一个东西”。

**=> 这种时候，权重大小就不稳定、不可靠。**

举个例子：
假设有一个特征是，是否游玩了长隆海洋王国。然后我们发现游客中“去过长隆海洋王国”的人在问卷中更倾向于说“我想再来珠海”，训练后模型里这个特征的权重很高。

可能得出武断绝对的结论：“去海洋王国会导致他们想再来！”

但实际可能是：
- 是因为他们本身就喜欢大型亲子游乐场（偏好驱动）；
- 是因为他们住的高端酒店 (高预算) 提供了优质服务（服务驱动）；
- 又或是只在那边玩了1天还没玩够（时间未满足，玩得久了，都逛完了可能就不想来了）。

 也就是说：**“去海洋王国”和“想再来珠海”是相关的，但不能武断的下结论说前者是后者的原因**。  

==但是这个还是有意义的，这个权重反映的这种相关性，还是能说明，至少去珠海长隆这个景区有更大的概率会使人更想重游珠海，只是不能说只要去了长隆，就能让人想再来，因为这个重游的意愿是多个因素共同影响的。但是这也有价值了，比如要宣传珠海，吸引游客，我们可以参照这个权重，来重点宣传==

而且事实上，长隆是珠海一个很出名的景点，出名的景点往往成为人们去旅游的原因，也是重游的原因，比如湖南的张家界，比如一家有名的好吃的饭店，让人总想再吃。


这种多重共线或者说交互效应 (互相影响) 这个可以查一下，应该有类似的研究的。就是如何处理这样的，排除这样的影响。
可能控制变量法就可以吧。多做一些实验，每次只改变一个因素，然后重新训练模型，看模型的准确率提高了多少或者下降了多少。比如我把性别这个特征的数据全部修改为女性 （甚至删除性别这个特征），其他特征不变，输入给模型训练，看模型的预测准确率是否变化，如果没有什么变化，那就说明性别这个特征对于最终的预测结果准确率影响很小，这个特征就是可有可无的，其权重就应该很小，即应该约等于0。

然后再控制变量是否去了长隆，将其修改，比如将去了的变为没去，没去的变为去了，（即反转了），其余不变，训练模型，看预测值的准确率，如果这个特征非常重要，确实非常影响人们的重游意愿，那么准确率应该非常显著的下降，下降非常非常多，比如从80%的准确率下降到只有20%了。说明改动这一个特征会带来60%的性能下降。

同样的再控制变量是否是亲子游。（因为我们怀疑是否去长隆这一特征与是否是亲子游也高度相关，那么我们要验证下是否存在这样的交互效应），结果发现，改动了是否亲子游这个指标，模型的准确率从80%下降到了70%，确实下降了，但是仅10%，远远小于改变是否去长隆这个特征所带来的下降（60%），那就能证明其实它们两个没有那么强烈的共线效应，因为如果这两个因素常常同时出现，那么无论改变哪一个，对准确率造成的下降应该是差不多的，但是出现这么大的差距（60% vs 10%）说明其实这两个不是那么互相影响的。（这个我不是那么确定，需要再思考探索）

但是，这样的一个控制变量的实验给了我一个新思路，那就是可以看修改某一个特征给模型准确率带来的变化多少，来衡量，量化哪一个特征更加影响准确率，也就是模型对哪一个特征的变化更加敏感，比如上面的例子里，是否去长隆这个特征就肯定是比性别这个特征更加影响模型。


如何收集数据：
就是一个调查问卷，将上面这些我们想收集的特征和预测值等都包含在问卷设置的问题里，然后去找那些来珠海旅游的人做，收集好结果。比如去珠海长隆等这些旅游地点。或者放宽到找一些外地人做也可以，澳门大部分学生就行，他们来自大陆五湖四海，居住在珠海，也算半个旅客吧，也去一些地方玩过。凑人数。


如果这个模型能够被很好的训练出来，以后可以用于
- 预测一个人是否会重游珠海，只需要他提供那些特征
- 可以为旅游宣传提供方向，即应该如何侧重的宣称，如何更能吸引游客，促进旅游业
- 可以高效的评估某一个因素对重游珠海的影响程度。（比如要加一个新的特征， 那就加进来，输给模型，重新训练，模型就也会给这个新特征一个权重嘛，这个权重就可以表示这个新特征的重要性）



==下面是ChatGPT，其提供的一个流程，（仅参考下吧，我也不知道对不对，里面有些东西我也不懂）：==

### Step 1. 采集真实游客反馈数据

- **问卷设计**：涵盖上述 X 和 Y
    
- **人群来源**：景区问卷、OTA 平台（如携程/马蜂窝）、微信公众号抽样、街头拦访
    
- **样本量**：建议至少 500–1000 人，可使用电访+线上问卷混合
    

---

### Step 2. 描述统计 + 可视化探索

- 对每个变量做基本统计（均值、分布）
    
- 用分组比较方法看哪些变量在愿意/不愿意人群中差异大
    

---

###  Step 3. 建立因果图（Causal Graph）

- 手动画出变量之间的结构（用 DAG 图）
    
- 明确哪些是潜在混淆变量、工具变量、媒介变量
    
- 可借助工具：DAGitty
    

---

###  Step 4. 倾向得分匹配 (Propensity Score Matching)

**目标：模拟“如果预算是高 vs 低”的干预，估计其对 Y 的影响**

- 每次控制一个变量，比如“高 vs 低预算”，做匹配后比较平均重游评分差
    
- 可以做多次模拟干预，得出**每个特征的平均因果效应（ATE）**
    

---

### Step 5. 建模 + 解释（用于补充/交叉验证）

- 模型选择：Logistic 回归、随机森林、XGBoost、因果森林（causal forest）
    
- 对每个特征使用 SHAP 值分析其“在控制住其他变量时对重游意愿的影响”





## 倾向得分匹配（**Propensity Score Matching, PSM**）

### 核心问题

你想研究某个变量（如“高预算”）是否**因果性地影响**“重游意愿”。  
但你不是在做随机实验，所以“高预算”和“是否愿意重游”之间可能还有很多**背景因素（confounders）影响，例如收入、教育、年龄、兴趣**。

所以我们需要模拟一个“随机实验”：  
**“如果两个游客在其他条件都相同的情况下，只有预算不同，是否真的预算更高的那位更想重游？”**

这就是 PSM 的作用：**构造相似背景的对照组，隔离变量影响，近似估计因果效应。**


#### 明确你要分析的“处理变量”（treatment）

比如：

- 处理组：高预算游客（预算 > 1000 元）
- 对照组：低预算游客（预算 ≤ 1000 元）
    

我们想知道：**高 vs 低预算，对重游意愿的平均因果效应（Average Treatment Effect on the Treated, ATT）是多少？**


==我感觉它搞复杂了，我也不知道这个倾向匹配得分是什么。==